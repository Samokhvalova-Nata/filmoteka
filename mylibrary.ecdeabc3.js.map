{"mappings":"AAAA,MAKMA,EAAsBC,SAASC,cAAc,wBAC7CC,EAAiBF,SAASC,cAAc,wBACxCE,EAAqBH,SAASC,cAAc,yBAC5CG,EAAeJ,SAASC,cAAc,iBACtCI,EAAWL,SAASC,cAAc,iBAaxC,SAASK,EAAkBC,GACN,WAAfA,EAAMC,OACRC,IACAT,SAASU,oBAAoB,UAAWJ,G,CAI5C,SAASK,EAAoBJ,GACvBA,EAAMK,gBAAkBL,EAAMM,SAChCJ,IACAT,SAASU,oBAAoB,UAAWJ,G,CAS5C,SAASG,IACPJ,EAASS,UAAY,IACrBV,EAAaW,UAAUC,OAAO,mBAC9Bd,EAAea,UAAUC,OAAO,mBAChChB,SAASiB,iBAAiB,UAAWX,E,CAGvC,SAASY,EAAaC,GACpBC,QAAQC,KAAKF,E,CAGf,SAASG,EAAoBC,GAC3B,IAAIC,EACJD,EAAKE,QAAQC,SAAQC,IACH,qBAAZA,EAAGC,MAA2C,uBAAZD,EAAGC,OACvCJ,EAAMG,EAAGH,IAAG,IAGhBnB,EAASwB,mBACP,YACA,4FAE2CL,0O,CApD/CrB,EAAmBc,iBAAiB,SAGpC,YAqEAa,eAAkCC,SAXlCD,eAAiCC,GAC/B,OAAOC,MACL,sCAAuBD,oEACvBE,MAAKC,IACL,IAAKA,EAAEC,GACL,MAAM,IAAIC,MAAMF,EAAEG,QAEpB,OAAOH,EAAEI,MAAM,G,CAKJC,CAAkBR,GAC5BE,KAAKX,GACLkB,MAAMtB,E,EAvETuB,CAZc,QAadvC,EAAea,UAAUC,OAAO,mBAChCZ,EAAaW,UAAUC,OAAO,mBAC9Bd,EAAee,iBAAiB,QAASN,GACzCX,SAASiB,iBAAiB,UAAWX,E,IAPvCP,EAAoBkB,iBAAiB,SAwBrC,WACER,IACAT,SAASU,oBAAoB,UAAWJ,E","sources":["src/js/trailer-modal.js"],"sourcesContent":["const API_KEY = '7fc57a32bb8b4747bafc97bb7301e33f';\nconst BASE_API = 'https://api.themoviedb.org';\n\nconst movieId = 948713;\n\nconst trailerModalCloseEl = document.querySelector('[data-trailer-close]');\nconst trailerModalEl = document.querySelector('[data-trailer-modal]');\nconst trailerModalOpenEl = document.querySelector('.modal__watch-treller');\nconst movieModalEl = document.querySelector('.modal__movie');\nconst iframeEl = document.querySelector('[data-iframe]');\n\ntrailerModalOpenEl.addEventListener('click', handleOpenTrailerClick);\ntrailerModalCloseEl.addEventListener('click', handleCloseTrailerBtnClick);\n\nfunction handleOpenTrailerClick() {\n  renderTrailerModal(movieId);\n  trailerModalEl.classList.toggle('visually-hidden');\n  movieModalEl.classList.toggle('visually-hidden');\n  trailerModalEl.addEventListener('click', handleBackdropClick);\n  document.addEventListener('keydown', handleEscapeClick);\n}\n\nfunction handleEscapeClick(event) {\n  if (event.code === 'Escape') {\n    toggleModal();\n    document.removeEventListener('keydown', handleEscapeClick);\n  }\n}\n\nfunction handleBackdropClick(event) {\n  if (event.currentTarget === event.target) {\n    toggleModal();\n    document.removeEventListener('keydown', handleEscapeClick);\n  }\n}\n\nfunction handleCloseTrailerBtnClick() {\n  toggleModal();\n  document.removeEventListener('keydown', handleEscapeClick);\n}\n\nfunction toggleModal() {\n  iframeEl.innerHTML = ' ';\n  movieModalEl.classList.toggle('visually-hidden');\n  trailerModalEl.classList.toggle('visually-hidden');\n  document.addEventListener('keydown', handleEscapeClick);\n}\n\nfunction onFetchError(err) {\n  console.warn(err);\n}\n\nfunction findOfficialTrailer(data) {\n  let key;\n  data.results.forEach(el => {\n    if (el.name === 'Official Trailer' || el.name === 'Official Trailer 1') {\n      key = el.key;\n    }\n  });\n  iframeEl.insertAdjacentHTML(\n    'beforeend',\n    `<iframe\n          class=\"trailer__iframe\"\n          src=\"https://www.youtube.com/embed/${key}\"\n          title=\"Official trailer\"\n          frameborder=\"0\"\n          allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\"\n          allowfullscreen\n        ></iframe>`\n  );\n}\n\nasync function fetchMovieTrailer(id) {\n  return fetch(\n    `${BASE_API}/3/movie/${id}/videos?api_key=${API_KEY}&language=en-US`\n  ).then(r => {\n    if (!r.ok) {\n      throw new Error(r.status);\n    }\n    return r.json();\n  });\n}\n\nasync function renderTrailerModal(id) {\n  return await fetchMovieTrailer(id)\n    .then(findOfficialTrailer)\n    .catch(onFetchError);\n}\n"],"names":["$a9681b415a326b23$var$trailerModalCloseEl","document","querySelector","$a9681b415a326b23$var$trailerModalEl","$a9681b415a326b23$var$trailerModalOpenEl","$a9681b415a326b23$var$movieModalEl","$a9681b415a326b23$var$iframeEl","$a9681b415a326b23$var$handleEscapeClick","event","code","$a9681b415a326b23$var$toggleModal","removeEventListener","$a9681b415a326b23$var$handleBackdropClick","currentTarget","target","innerHTML","classList","toggle","addEventListener","$a9681b415a326b23$var$onFetchError","err","console","warn","$a9681b415a326b23$var$findOfficialTrailer","data","key","results","forEach","el","name","insertAdjacentHTML","async","id","fetch","then","r","ok","Error","status","json","$a9681b415a326b23$var$fetchMovieTrailer","catch","$a9681b415a326b23$var$renderTrailerModal"],"version":3,"file":"mylibrary.ecdeabc3.js.map"}