{"mappings":"gfAAAA,EAAA,S,WAK4BC,SAASC,cAAc,wBAC5BD,SAASC,cAAc,wBACnBD,SAASC,cAAc,yBAC7BD,SAASC,cAAc,iBAC3BD,SAASC,cAAc,gB","sources":["src/js/trailer-modal.js"],"sourcesContent":["const API_KEY = '7fc57a32bb8b4747bafc97bb7301e33f';\nconst BASE_API = 'https://api.themoviedb.org';\n\nconst movieId = 948713;\n\nconst trailerModalCloseEl = document.querySelector('[data-trailer-close]');\nconst trailerModalEl = document.querySelector('[data-trailer-modal]');\nconst trailerModalOpenEl = document.querySelector('.modal__watch-treller');\nconst movieModalEl = document.querySelector('.modal__movie');\nconst iframeEl = document.querySelector('[data-iframe]');\n\n// trailerModalOpenEl.addEventListener('click', handleOpenTrailerClick);\n// trailerModalCloseEl.addEventListener('click', handleCloseTrailerBtnClick);\n\nfunction handleOpenTrailerClick() {\n  renderTrailerModal(movieId);\n  trailerModalEl.classList.toggle('visually-hidden');\n  movieModalEl.classList.toggle('visually-hidden');\n  trailerModalEl.addEventListener('click', handleBackdropClick);\n  document.addEventListener('keydown', handleEscapeClick);\n}\n\nfunction handleEscapeClick(event) {\n  if (event.code === 'Escape') {\n    toggleModal();\n    document.removeEventListener('keydown', handleEscapeClick);\n  }\n}\n\nfunction handleBackdropClick(event) {\n  if (event.currentTarget === event.target) {\n    toggleModal();\n    document.removeEventListener('keydown', handleEscapeClick);\n  }\n}\n\nfunction handleCloseTrailerBtnClick() {\n  toggleModal();\n  document.removeEventListener('keydown', handleEscapeClick);\n}\n\nfunction toggleModal() {\n  iframeEl.innerHTML = ' ';\n  movieModalEl.classList.toggle('visually-hidden');\n  trailerModalEl.classList.toggle('visually-hidden');\n  document.addEventListener('keydown', handleEscapeClick);\n}\n\nfunction onFetchError(err) {\n  console.warn(err);\n}\n\nfunction findOfficialTrailer(data) {\n  let key;\n  data.results.forEach(el => {\n    if (el.name === 'Official Trailer' || el.name === 'Official Trailer 1') {\n      key = el.key;\n    }\n  });\n  iframeEl.insertAdjacentHTML(\n    'beforeend',\n    `<iframe\n          class=\"trailer__iframe\"\n          src=\"https://www.youtube.com/embed/${key}\"\n          title=\"Official trailer\"\n          frameborder=\"0\"\n          allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\"\n          allowfullscreen\n        ></iframe>`\n  );\n}\n\nasync function fetchMovieTrailer(id) {\n  return fetch(\n    `${BASE_API}/3/movie/${id}/videos?api_key=${API_KEY}&language=en-US`\n  ).then(r => {\n    if (!r.ok) {\n      throw new Error(r.status);\n    }\n    return r.json();\n  });\n}\n\nasync function renderTrailerModal(id) {\n  return await fetchMovieTrailer(id)\n    .then(findOfficialTrailer)\n    .catch(onFetchError);\n}\n"],"names":["parcelRequire","document","querySelector"],"version":3,"file":"mylibrary.617b046e.js.map"}